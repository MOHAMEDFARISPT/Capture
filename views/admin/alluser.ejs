<%- include('../adminpartials/header')%>
<%- include('../adminpartials/slidebar')%>
<!-- Include SweetAlert CSS and JS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>

   

            <!-- Container-fluid starts-->
            <div class="page-body">
                <!-- All User Table Start -->
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-12">
                            <div class="card card-table">
                                <div class="card-body">
                                    <div class="title-header option-title">
                                        <h5>All Users</h5>
                                        <!-- <form class="d-inline-flex">
                                            <a href="add-new-user.html" class="align-items-center btn btn-theme d-flex">
                                                <i data-feather="plus"></i>Add New
                                            </a>
                                        </form> -->
                                    </div>

                                    <div class="table-responsive table-product">
                                        <table class="table all-package theme-table" id="table_id">
                                            <thead>
                                                <tr>
                                                    <!-- <th>User</th> -->
                                                    <th class="text-center">FirstName</th>
                                                    <th class="text-center">LastName</th>
                                                    <th class="text-center">Email</th>
                                                    <th>contact</th>
                                                    <th>Action on users</th>
                                                </tr>
                                            </thead>

                                            <tbody>
                                                <%userdatas.forEach((iteam)=>{%>
                                                    <tr>
                                                      <td class="text-center"><%=iteam.firstname%></td>
                                                      <td class="text-center"><%=iteam.lastname%></td>
                                                      <td class="text-center"><%=iteam.email%></td>
                                                      <td class="text-center"><%=iteam.contact%></td>

                                                      <td class="d-flex justify-content-center text-center">
                                                        <% if(iteam.isblocked) { %>
                                                      <button class="btn btn-info btn-primary " onclick="blockUser('<%= iteam._id %>')">Unblock</button>

                                                      <% } else{ %>
                                                        <button class="btn btn-info btn-primary " onclick="blockUser('<%= iteam._id %>')">block</button>
                                                        <% } %>
                                                      </td>
                                                    </tr>
                                                 <%})%>



                                                <!-- <tr>
                                                    
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/1.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Everett C. Green</span>
                                                            <span>Essex Court</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 802 - 370 - 2430</td>

                                                    <td>EverettCGreen@rhyta.com</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/2.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Caroline L. Harris</span>
                                                            <span>Davis Lane</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 720 - 276 - 9403</td>

                                                    <td>CarolineLHarris@rhyta.com</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/3.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Lucy j. Morile</span>
                                                            <span>Clifton</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 351 - 756 - 6549</td>

                                                    <td>LucyMorile456@gmail.com</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/4.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Jennifer A. Straight</span>
                                                            <span>Brunswick</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 912 - 265 - 1550</td>

                                                    <td>JenniferAStraight@rhyta.com</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/5.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Louise J. Stiles</span>
                                                            <span>Indianapolis</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 304 - 921 - 8122</td>

                                                    <td>KevinAMillett@jourrapide.com</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/1.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Scott T. Thomas</span>
                                                            <span>Kotzebue</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 907 - 442 - 8122</td>

                                                    <td>scott.thomas@packiu.com</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/2.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Everett C. Green</span>
                                                            <span>Essex Court</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 218 - 244 - 7026</td>

                                                    <td>KevinAMillett@jourrapide.com</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/3.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Dillon J. Bradshaw</span>
                                                            <span>Redbud Drive</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 347 - 649 - 7283</td>

                                                    <td>DillonJBradshaw@teleworm.us</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/4.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Lorna M. Bonner</span>
                                                            <span>Broadway Street</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 843 - 765 - 6166</td>

                                                    <td>LornaMBonner@teleworm.us</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/5.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Everett C. Green</span>
                                                            <span>Essex Court</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 802 - 370 - 2430</td>

                                                    <td>EverettCGreen@rhyta.com</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr>

                                                <tr>
                                                    <td>
                                                        <div class="table-image">
                                                            <img src="/assetsb/images/users/1.jpg" class="img-fluid"
                                                                alt="">
                                                        </div>
                                                    </td>

                                                    <td>
                                                        <div class="user-name">
                                                            <span>Lorraine D. McDowell</span>
                                                            <span>Woodland Terrace</span>
                                                        </div>
                                                    </td>

                                                    <td>+ 916 - 942 - 7555</td>

                                                    <td>LorraineDMcDowell@dayrep.com</td>

                                                    <td>
                                                        <ul>
                                                            <li>
                                                                <a href="order-detail.html">
                                                                    <i class="ri-eye-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)">
                                                                    <i class="ri-pencil-line"></i>
                                                                </a>
                                                            </li>

                                                            <li>
                                                                <a href="javascript:void(0)" data-bs-toggle="modal"
                                                                    data-bs-target="#exampleModalToggle">
                                                                    <i class="ri-delete-bin-line"></i>
                                                                </a>
                                                            </li>
                                                        </ul>
                                                    </td>
                                                </tr> -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- All User Table Ends-->

                <div class="container-fluid">
                    <!-- footer start-->
                    <footer class="footer">
                        <div class="row">
                            <div class="col-md-12 footer-copyright text-center">
                                <p class="mb-0">Copyright 2022 © Fastkart theme by pixelstrap</p>
                            </div>
                        </div>
                    </footer>
                    <!-- footer end-->
                </div>
            </div>

            <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>

            <script>
                async function blockUser(userId) {
                    try {
                        
                        // Show a SweetAlert confirmation dialog
                        const confirmation = await Swal.fire({
                            title: 'Confirmation',
                            text: 'Are you sure you want to block/unblock this user?',
                            icon: 'question',
                            showCancelButton: true,
                            confirmButtonText: 'Yes',
                            cancelButtonText: 'No',
                        });
            
                        if (confirmation.isConfirmed) {
                            // If the user confirms, make the fetch request
                            const response = await fetch(`/admin/blockUser/${userId}`, {
                                method: 'post',
                            });
            
                            if (!response.ok) {
                                throw new Error(`HTTP error! Status: ${response.status}`);
                            }
            
                            const result = await response.json();
            
                            // Display a success message with SweetAlert
                            Swal.fire({
                                title: 'Success',
                                text: result.message, // Adjust this based on your server response
                                icon: 'success',
                                confirmButtonText: 'OK',
                            });
            
                            // Reload the page after success
                            window.location.reload();
                        }
                    } catch (error) {
                        // Display an error message with SweetAlert
                        console.error('Fetch error:', error);
                        Swal.fire({
                            title: 'Error',
                            text: 'An error occurred while processing your request.',
                            icon: 'error',
                            confirmButtonText: 'OK',
                        });
                    }
                }
            </script>
            

          
            <%- include('../adminpartials/footer')%>
           